🐱 Legitimate User has 🔄 Refresh Token 1 and 🔑 Access Token 1.

😈 Malicious User manages to steal 🔄 Refresh Token 1 from 🐱 Legitimate User.

🐱 Legitimate User uses 🔄 Refresh Token 1 to get a new refresh-access token pair.

The 🚓 Auth0 Authorization Server returns 🔄 Refresh Token 2 and 🔑 Access Token 2 to 🐱 Legitimate User.

😈 Malicious User then attempts to use 🔄 Refresh Token 1 to get a new access token. Pure evil!

What do you think should happen next? Would 😈 Malicious User manage to get a new access token?

This is what happens when your identity platform has 🤖 Automatic Reuse Detection:

The 🚓 Auth0 Authorization Server has been keeping track of all the refresh tokens descending from the original refresh token. That is, it has created a "token family".

The 🚓 Auth0 Authorization Server recognizes that someone is reusing 🔄 Refresh Token 1 and immediately invalidates the refresh token family, including 🔄 Refresh Token 2.

The 🚓 Auth0 Authorization Server returns an Access Denied response to 😈 Malicious User.

🔑 Access Token 2 expires, and 🐱 Legitimate User attempts to use 🔄 Refresh Token 2 to request a new refresh-access token pair.

The 🚓 Auth0 Authorization Server returns an Access Denied response to 🐱 Legitimate User.

The 🚓 Auth0 Authorization Server requires re-authentication to get new access and refresh tokens.
