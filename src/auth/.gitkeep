ğŸ± Legitimate User has ğŸ”„ Refresh Token 1 and ğŸ”‘ Access Token 1.

ğŸ˜ˆ Malicious User manages to steal ğŸ”„ Refresh Token 1 from ğŸ± Legitimate User.

ğŸ± Legitimate User uses ğŸ”„ Refresh Token 1 to get a new refresh-access token pair.

The ğŸš“ Auth0 Authorization Server returns ğŸ”„ Refresh Token 2 and ğŸ”‘ Access Token 2 to ğŸ± Legitimate User.

ğŸ˜ˆ Malicious User then attempts to use ğŸ”„ Refresh Token 1 to get a new access token. Pure evil!

What do you think should happen next? Would ğŸ˜ˆ Malicious User manage to get a new access token?

This is what happens when your identity platform has ğŸ¤– Automatic Reuse Detection:

The ğŸš“ Auth0 Authorization Server has been keeping track of all the refresh tokens descending from the original refresh token. That is, it has created a "token family".

The ğŸš“ Auth0 Authorization Server recognizes that someone is reusing ğŸ”„ Refresh Token 1 and immediately invalidates the refresh token family, including ğŸ”„ Refresh Token 2.

The ğŸš“ Auth0 Authorization Server returns an Access Denied response to ğŸ˜ˆ Malicious User.

ğŸ”‘ Access Token 2 expires, and ğŸ± Legitimate User attempts to use ğŸ”„ Refresh Token 2 to request a new refresh-access token pair.

The ğŸš“ Auth0 Authorization Server returns an Access Denied response to ğŸ± Legitimate User.

The ğŸš“ Auth0 Authorization Server requires re-authentication to get new access and refresh tokens.
